"use strict";import{AppState as r}from"./AppState.js";import{PlaylistManager as e}from"./PlaylistManager.js";import{sendPlayCount as p}from"./survey.js";import{Content as l}from"./UI/Content.js";import{Header as d}from"./UI/Header.js";import{URLManager as n}from"./URLManager.js";let s=!1;export const safeSendPlayCount=t=>{!s&&!n.isDebugMode()&&(p(t),s=!0,setTimeout(()=>{s=!1},1e3))};export function handleQueryChange(){console.log("\u30AF\u30A8\u30EA\u30D1\u30E9\u30E1\u30FC\u30BF\u304C\u5909\u66F4\u3055\u308C\u307E\u3057\u305F: "),l.fadeIn();const t=e.getCurrentTrackTitle();d.setSearchBox("");const o=n.getSearchQuery();let i=r.data;o&&(i=r.data.filter(a=>a.tags.includes(o)||a.title.includes(o)||a.author===o),d.setSearchBox(o)),n.isDebugMode()&&(console.log("\u958B\u3051\u30B4\u30DE!"),l.debugLog.style.display="block"),e.setPlaylist(i,r.shuffleMode===1),e.currentTrackIndex=e.playlist.findIndex(a=>a.title===t),l.renderPlaylist(e.playlist),l.updatePlayingClass(e.currentTrackIndex)}window.addEventListener("popstate",t=>{t.preventDefault(),handleQueryChange(),console.log("popped")});
